/*! Kramgo Tictail Theme - v0.1.0 - copyrightish (c) 2013-05-17 Alexander Aivars, Kramgo AB */(function(){var t,e,i,s;i=!1,e=!1,t="index",s=function(){var t,e,i,s,n,r,o,h,a,l,d,c,u;if(krmg.ProductList.flush().load().index(),krmg.LazyImage.init(),krmg.LazyImage.load(),$(".product_slide_figure img").on("dragstart",function(t){return t.preventDefault(),!1}),n=$(".product_single .product_slide"),n.length)for(o=0,l=n.length;l>o;o++)e=n[o],r=new krmg.Swipe(e,{continuous:!0,disableScroll:!1,stopPropagation:!1,mouse:!0});if(n=$(".variations_select_label"),n.length)for(h=0,d=n.length;d>h;h++)e=n[h],s=new krmg.SelectLable(e);if(n=$(".html_content"),n.length){for(u=[],a=0,c=n.length;c>a;a++)t=n[a],i=krmg.ELEMENT.insertLater(t),krmg.ELEMENT.wash(t),t.className=t.className.replace(/html_content\s*/,""),u.push(i());return u}},$(document).ready(function(){var e,i;return i=new krmg.SlideMenu($(".page_body").first()),s(),e=".page_column",$.sammy(e,function(){return this.get("/",function(i){"index"!==t&&i.load("/").then(function(t){krmg.HTML.read(t,e),s()})}),this.get(/products\/(.*)/,function(i){var n;return n=i.params.splat[0],t=n,i.load("/products/"+n).then(function(t){krmg.HTML.read(t,e),s()})}),this.get(/product\/(.*)/,function(t){var e,i;e=t.params.splat[0],i=$(".page_column a[href$='product/"+e+"']"),$(".page_column .selected").removeClass("selected"),i.addClass("selected"),krmg.ProductList.show(this.path)}),this.get(/page\/(.*)/,function(i){var n;n=i.params.splat[0],t=n,i.load("/page/"+n).then(function(t){return krmg.ProductList.flush(),krmg.HTML.read(t,e),s()})}),this.bind("event-context-after",function(){var t;t=$("a[href$='"+this.path.replace(/^\/\#|^\//,"")+"']"),$("a.selected").removeClass("selected"),t.length?t.addClass("selected"):$("a[href='/']").addClass("selected"),i.close()})}).run()}),$(window).on("scroll",function(){return i?void 0:(i=!0,window.requestAnimationFrame(function(){return krmg.LazyImage.load(),i=!1}))}),$(window).on("resize",function(){return e?void 0:(e=!0,window.requestAnimationFrame(function(){return krmg.ProductList.index(),krmg.LazyImage.load(),e=!1}))})}).call(this),function(){var t,e,i,s,n;null==(n=(s="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(s.krmg={}),t="data-src",i=[],e=function(t,e){var i,s;return i=t.offsetParent,s=t.parentNode.getBoundingClientRect(),0===s.top?i?s=i.getBoundingClientRect():!1:s.top>=0&&e>=s.top||s.bottom>=0&&e>=s.bottom},krmg.LazyImage={init:function(){var e,s,n,r;for(s=document.getElementsByTagName("img"),n=0,r=s.length;r>n;n++)e=s[n],null!=e.getAttribute(t)&&i.push(e);return this},load:function(){var t,s,n,r,o,h,a;for(t=window.innerHeight||document.documentElement.clientHeight,n=[],r=0,h=i.length;h>r;r++)s=i[r],e(s,t)&&n.push(s);for(o=0,a=n.length;a>o;o++)s=n[o],this.get(s);return this},get:function(e){var i;return i=e.getAttribute(t),e.src!==i&&(e.src=i),this}}}.call(this),function(){var t,e;null==(e=(t="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(t.krmg={}),krmg.SlideMenu=function(){function t(t){var e=this;this.container=t,this.menu=$(".page_menu").first(),this.touch=Hammer(this.container),this.touch.on("touch dragleft dragright swipeleft swiperight release",function(t){return e.touchHandler(t)}),this.navigation=this.container.find(".page_navigation").first(),this.width=256,this.left=0,this.setOffset(this.left),Hammer($("[data-action=menu-toggle]").first()).on("tap",function(t){return e.actionHandler(t)}),$(window).on("resize",function(){return e.resize()}),this.resize()}return t.prototype.actionHandler=function(t){var e=this;return t.preventDefault(),t.gesture.preventDefault(),TweenLite.to(this,.25,{left:this.left>0?0:this.width,onUpdate:function(){return e.setOffset(e.left)}})},t.prototype.touchHandler=function(t){switch(t.preventDefault(),t.type){case"touch":this.delta=this.dragX;break;case"dragright":case"dragleft":t.gesture.preventDefault(),this.setOffset(Math.max(0,Math.min(this.width,t.gesture.deltaX+this.delta)));break;case"swiperight":this.setOffset(this.width,!0);break;case"swipeleft":this.setOffset(0,!0);break;case"release":this.dragX>.5*this.width?this.setOffset(this.width,!0):this.setOffset(0,!0)}},t.prototype.resize=function(){return this.navigation.css({minHeight:Math.max(this.container.height(),$(window).height())}),this},t.prototype.setOffset=function(t){return this.dragX=t,this.left=t,Modernizr.csstransforms3d?(this.container.css("transform","translate3d("+t+"px, 0, 0) scale3d(1,1,1)"),this.menu.css("transform","translate3d("+t+"px, 0, 0) scale3d(1,1,1)")):Modernizr.csstransforms?(this.container.css("transform","translate("+t+"px, 0)"),this.menu.css("transform","translate("+t+"px, 0)")):(this.container.css("left",""+(t-this.width)+"px"),this.menu.css("left",""+(t-this.width+this.width)+"px"))},t.prototype.close=function(){var t=this;return TweenLite.to(this,.25,{left:0,onUpdate:function(){return t.setOffset(t.left)}})},t}()}.call(this),function(){var t,e;t=function(t){var e,i;return i=t.parentNode,e=t.nextSibling,i.removeChild(t),function(){return e?i.insertBefore(t,e):i.appendChild(t)}},e=function(t){var i,s,n,r;if(t.removeAttribute("style"),t.children.length)for(r=t.children,s=0,n=r.length;n>s;s++)i=r[s],e(i);return t},$(document).ready(function(){var i,s,n,r,o;if(n=$(".html_content"),n.length)for(r=0,o=n.length;o>r;r++)i=n[r],s=t(i),e(i),i.className=i.className.replace(/html_content\s*/,""),s()})}.call(this),function(){var t,e,i;t=function(){function t(){this.list=[],this.first=[]}return t.prototype.show=function(t){var e,i,s,n,r,o,h,a,l;for(t=t.replace(krmg.RE.clean,""),e=null,a=this.list,n=0,o=a.length;o>n;n++)s=a[n],s.url===t&&(e=s);if(e){for(l=this.list,r=0,h=l.length;h>r;r++)s=l[r],s!==e&&s.row===e.row&&s.select(!1);return e.select(),this.active=e,this.insert_detail(e,e.row+1),i=0,TweenLite.to(window,.25,{scrollTo:{y:e.detail.offset().top-i,x:$(window).scrollLeft()},ease:Power2.easeIn}),this}},t.prototype.insert_detail=function(t,e){var i,s,n;this.container||(this.container=$(".product_list")),n=null,i=t.detail[0],s=t.container.parent()[0],this.first[e]&&(n=this.first[e].container[0]);try{s.insertBefore(i,n)}catch(r){console.log(r)}return this},t.prototype.load=function(){var t,e,i,s;if(e=$(".product_list .product"),e.length)for(i=0,s=e.length;s>i;i++)t=e[i],this.list.push(new krmg.Product($(t)));return this},t.prototype.index=function(){var t,e,i,s,n,r,o,h,a,l,d,c,u,f,p,m,g,v,w,x,y,k,b;for(n=r=-1,e=[];this.first.length;)this.first.pop();for(w=this.list,o=0,d=w.length;d>o;o++)t=w[o],t.selected&&(t.select(!1),e.push(t));for(x=this.list,h=0,c=x.length;c>h;h++)t=x[h],t.size("reset");for(y=this.list,a=0,u=y.length;u>a;a++)t=y[a],t.size("load");for(k=this.list,l=0,f=k.length;f>l;l++)t=k[l],t.size("write");for(b=this.list,g=0,p=b.length;p>g;g++)t=b[g],t.size().top>r&&(n++,this.first[n]=t),t.row=n,r=t.size().top;if(i=-1,this.active)for(v=0,m=e.length;m>v;v++)t=e[v],s=t.row+1,(t===this.active||t.row!==this.active.row&&s!==i)&&(this.insert_detail(t,s),t.select(!0),i=s);return this},t.prototype.flush=function(){for(this.active=null;this.first.length;)this.first.pop();for(;this.list.length;)this.list.pop()["delete"]();return this},t}(),null==(i=(e="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(e.krmg={}),krmg.ProductList=new t}.call(this),function(){var t,e;null==(e=(t="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(t.krmg={}),krmg.Product=function(){function t(t){this.container=t,this.teaser=this.container.find(".product_teaser").first(),this.detail=this.container.find(".product_detail").first(),this.slider=this.container.find(".product_slide").first(),this.images=this.container.find(".product_slide_figure img"),this.hover=this.container.find(".product_teaser_hover .wrapper").first(),this.swipe=null,this.detail.detach(),this.detail.show(),this.row=0,this.url=this.teaser.attr("href").replace(krmg.RE.clean,"")}return t.prototype.select=function(t){var e,i,s,n,r;if(this.selected=null!=t?t:!0,this.selected){for(r=this.images,s=0,n=r.length;n>s;s++)e=r[s],i=e.getAttribute("data-src"),e.removeAttribute("data-src"),null!=i&&(e.src=i);!this.swipe&&this.images.length>1?this.swipe=new krmg.Swipe(this.slider[0],{continuous:!0,disableScroll:!1,stopPropagation:!1,mouse:!0}):this.swipe&&this.swipe.setup()}else this.detail.detach();return this},t.prototype.size=function(t){return"reset"===t?this.hover.removeAttr("style"):"load"===t?(this.hover_bounds=this.hover[0].getBoundingClientRect(),this.container_bounds=this.container[0].getBoundingClientRect(),this.list_bounds=$(".product_list")[0].getBoundingClientRect()):(t="write")&&(this.slider.css({width:this.list_bounds.width,height:Math.round(this.list_bounds.width*(2/3))}),this.slider.width(this.list_bounds.width)),this.container_bounds},t.prototype.top=function(){return this.container.position().top},t.prototype["delete"]=function(){var t;for(t in this)this[t]instanceof jQuery&&this[t].off(),this.hasOwnProperty(t)&&(this[t]=null)},t}()}.call(this),function(){var t,e;null==(e=(t="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(t.krmg={}),krmg.SelectLable=function(){function t(t){return this.label=t instanceof jQuery?t:$(t),this.select=this.label.prev(),this.select.hasClass("tictail_variations_select")?(this.setup(),void 0):(this.label=null,this.select=null,void 0)}return t.prototype.prefix="",t.prototype.setup=function(){var t=this;this.select.on("change",function(){return t.changed()}),this.changed()},t.prototype.changed=function(){var t;try{return t=$(this.select[0].options[this.select[0].selectedIndex]),this.label.html(t[0].innerHTML)}catch(e){return console.log(e)}},t}()}.call(this),function(){"use strict";var t,e,i,s,n;e=function(){},i=function(t){return setTimeout(t||e,0)},t={addEventListener:!!window.addEventListener,touch:Modernizr.touch,transitions:Modernizr.csstransitions},null==(n=(s="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(s.krmg={}),krmg.Swipe=function(){function e(e,i){var s,n,r=this;return this.container=e,e?(this.options=i||{},this.element=e.children[0],this.index=parseInt(i.startSlide,10)||0,this.speed=i.speed||300,this.slides=null,this.slidePos=null,this.width=null,this.timer=null,this.interactive=!1,this.swiped=!1,this.delay=i.auto||0,this.interval=null,this.touch=Hammer(this.container),this.touch.on("touch dragleft swipeleft dragright swiperight release",function(t){return r.handleTouch(t)}),i.mouse&&this.touch.on("click mousemove mouseout",function(t){return r.handleMouse(t)}),this.onresize=function(){return requestAnimationFrame(function(){return r.setup()})},t.transitions&&(n=function(t){return r.handleTransition(t)},this.element.addEventListener("webkitTransitionEnd",n,!1),this.element.addEventListener("msTransitionEnd",n,!1),this.element.addEventListener("oTransitionEnd",n,!1),this.element.addEventListener("otransitionend",n,!1),this.element.addEventListener("transitionend",n,!1)),t.addEventListener?window.addEventListener("resize",function(){return r.onresize()}):window.onresize=this.onresize,this.setup(),this.delay&&setTimeout(function(){return r.begin()},i.delay||0),s={setup:function(){return r.setup(),r},slide:function(t,e){return r.slide(t,e),r},prev:function(){return r.stop(),r.prev(),r},next:function(){return r.stop(),r.next(),r},getPos:function(){return r.index},kill:function(){r.teardown()}},s.__proto__=this.__proto__,s):void 0}return e.prototype.teardown=function(){var e,i;for(this.stop(),this.element.style.width="auto",this.element.style.left=0,e=this.slides.length;e--;)i=this.slides[e],i.style.width="100%",i.style.left=0,t.transitions&&this.translate(e,0,0);this.touch.off("touch dragleft swipeleft dragright swiperight release"),this.touch.off("click mousemove mouseout"),t.addEventListener?window.removeEventListener("resize",this.onresize):window.onresize=null},e.prototype.setup=function(){var e,i,s;for(this.pageWidth=$(window).width(),this.slides=this.element.children,this.slidePos=Array(this.slides.length),e=this.container.getBoundingClientRect(),this.width=$(this.container).width(),this.height=$(this.container).height(),this.element.style.width=this.slides.length*this.width+"px",i=this.slides.length;i--;)s=this.slides[i],s.style.width=this.width+"px",s.setAttribute("data-index",i),t.transitions&&(s.style.left=i*-this.width+"px",this.move(i,this.index>i?-this.width:i>this.index?this.width:0,0));t.transitions||(this.element.style.left=this.index*-this.width+"px"),this.container.style.visibility="visible"},e.prototype.translate=function(t,e,i){var s,n;s=this.slides[t],n=s&&s.style,n&&(n.webkitTransitionDuration=n.MozTransitionDuration=n.msTransitionDuration=n.OTransitionDuration=n.transitionDuration=i+"ms",n.webkitTransform="translate3d("+e+"px, 0, 0) scale3d(1,1,1)",n.msTransform=n.MozTransform=n.OTransform="translateX("+e+"px)")},e.prototype.move=function(t,e,i){this.translate(t,e,i),this.slidePos[t]=e},e.prototype.prev=function(){this.index?this.slide(this.index-1):this.options.continuous&&this.slide(this.slides.length-1)},e.prototype.next=function(){this.index<this.slides.length-1?this.slide(this.index+1):this.options.continuous&&this.slide(0)},e.prototype.slide=function(e,s){var n,r;if(this.index!==e){if(null==s&&(s=this.speed),t.transitions){for(n=Math.abs(this.index-e)-1,r=Math.abs(this.index-e)/(this.index-e);n--;)this.move((e>this.index?e:this.index)-n-1,this.width*r,0);this.move(this.index,this.width*r,s),this.move(e,0,s)}else this.animate(this.index*-this.width,e*-this.width,s);this.index=e,i(this.options.callback&&this.options.callback(this.index,this.slides[this.index]))}},e.prototype.animate=function(t,e,i){var s,n=this;return i?(s=+new Date,this.timer=setInterval(function(){var r;return r=+new Date-s,r>i?(n.element.style.left=e+"px",n.delay&&n.begin(),n.options.transitionEnd&&n.options.transitionEnd.call(event,n.index,n.slides[n.index]),clearInterval(n.timer),void 0):n.element.style.left=(e-t)*(Math.floor(100*(r/i))/100)+t+"px"},4),void 0):(this.element.style.left=e+"px",void 0)},e.prototype.begin=function(){var t=this;this.interval=setTimeout(function(){return t.next()},this.delay)},e.prototype.stop=function(){this.delay=0,clearTimeout(this.interval)},e.prototype.handleTransition=function(t){var e=this;parseInt(t.target.getAttribute("data-index"),10)===this.index&&(this.delay&&requestAnimationFrame(function(){return e.begin()}),this.options.transitionEnd&&this.options.transitionEnd.call(t,this.index,this.slides[this.index]))},e.prototype.render=function(){return this.interactive?(this.translate(this.index-1,this.lastDelta+this.slidePos[this.index-1],0),this.translate(this.index,this.lastDelta+this.slidePos[this.index],0),this.translate(this.index+1,this.lastDelta+this.slidePos[this.index+1],0)):void 0},e.prototype.handleMouse=function(t){var e;if(this.interactive){if("none"===this.clickAction)return;this.container.removeAttribute("data-click"),this.clickAction="none"}else if("click"===t.type)"next"===this.clickAction&&this.next(),"prev"===this.clickAction&&this.prev();else if("mouseout"===t.type)e=this.container.getBoundingClientRect(),(t.clientY<=e.top||t.clientY>=e.height+e.top||t.clientX<=e.left||t.clientX>=e.width+e.left)&&(this.container.removeAttribute("data-click"),this.clickAction="none");else if(t.pageX>.5*this.pageWidth){if("next"===this.clickAction)return;this.container.setAttribute("data-click","next"),this.clickAction="next"}else{if("prev"===this.clickAction)return;this.container.setAttribute("data-click","prev"),this.clickAction="prev"}},e.prototype.handleTouch=function(t){var e,i,s,n=this;switch(t.stopPropagation(),t.stopImmediatePropagation(),e=t.gesture.deltaX,clearTimeout(this.interval),t.type){case"touch":this.interactive=!0,this.swiped=!1;break;case"dragright":case"dragleft":t.gesture.preventDefault(),(!this.index&&e>0||this.index===this.slides.length-1&&0>e)&&(e/=Math.abs(e)/this.width+1),this.lastDelta=e,requestAnimationFrame(function(){return n.render()});break;case"swiperight":case"swipeleft":t.gesture.preventDefault(),this.interactive=!1,this.swiped=!1;break;case"release":this.interactive=!1,s=Math.abs(e)>.5*this.width||this.swiped,i=!this.index&&e>0||this.index===this.slides.length-1&&0>e,s&&!i?"left"===t.gesture.direction?(this.move(this.index-1,-this.width,0),this.move(this.index,this.slidePos[this.index]-this.width,this.speed),this.move(this.index+1,this.slidePos[this.index+1]-this.width,this.speed),this.index+=1):(this.move(this.index+1,this.width,0),this.move(this.index,this.slidePos[this.index]+this.width,this.speed),this.move(this.index-1,this.slidePos[this.index-1]+this.width,this.speed),this.index+=-1):(this.move(this.index-1,-this.width,this.speed),this.move(this.index,0,this.speed),this.move(this.index+1,this.width,this.speed))}},e}()}.call(this),function(){var t,e;null==(e=(t="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(t.krmg={}),krmg.RE={wash1:/<(script|head|style|iframe|frame|noscript)[^\>]*>[\s\S]*?<\/.*?\1>/gi,wash2:/<(!doctype|head|html|body).*?>/gi,wash3:/<\/.*?(head|html|body)>/gi,wash4:/<!--[\s\S]*?-->/gi,clean:/^\/\#|^\/|\#|\/\#/},krmg.HTML={wash:function(t){return t=t.replace(krmg.RE.wash1,""),t=t.replace(krmg.RE.wash2,""),t=t.replace(krmg.RE.wash3,""),t=t.replace(krmg.RE.wash4,"")},read:function(t,e){var i,s;if(t=this.wash(t),s=document,null!=document.implementation&&null!=document.implementation.createHTMLDocument)try{s=document.implementation.createHTMLDocument("")}catch(n){s=document}i=s.createElement("div"),i.innerHTML=t,$(e).first().html($(i).find(e).first().html());try{return TT.store.domReady()}catch(n){return console.log("Missing TT.store.domReady")}}},krmg.ELEMENT={wash:function(t){var e,i,s,n;if(t.removeAttribute("style"),t.children.length)for(n=t.children,i=0,s=n.length;s>i;i++)e=n[i],this.wash(e);return t},insertLater:function(t){var e,i;return i=t.parentNode,e=t.nextSibling,i.removeChild(t),function(){return e?i.insertBefore(t,e):i.appendChild(t)}}}}.call(this);