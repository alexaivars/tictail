/*! Kramgo Tictail Theme - v0.1.0 - copyrightish (c) 2013-07-07 Alexander Aivars, Kramgo AB */!function(){var a,b,c,d,e,f,g;e=!1,d=!1,b=null,a=null,g=null,f=function(){var a,b,c,d,e,f,h,i,j,k,l,m;if(e=$(".variations_select_label"),e.length)for(f=0,j=e.length;j>f;f++)b=e[f],d=new krmg.SelectLable(b);if(krmg.ProductList.flush().load(),krmg.ProductList.index(),krmg.LazyImage.init(),krmg.LazyImage.load(),$(".product_slide_figure img").on("dragstart",function(a){return a.preventDefault(),!1}),e=$(".product_single"),e.length)for(h=0,k=e.length;k>h;h++)b=e[h],g=new krmg.Product($(b));if(e=$(".html_content"),e.length){for(m=[],i=0,l=e.length;l>i;i++)a=e[i],c=krmg.ELEMENT.insertLater(a),krmg.ELEMENT.wash(a),a.className=a.className.replace(/html_content\s*/,""),m.push(c());return m}},$(document).ready(function(){var c,d,e,g,h,i;return g=[document.getElementById("page")],i=$("#tt_colophon"),e={},h=$("#tictail_search_box"),h.length&&h.attr("placeholder","Search"),e=Modernizr.touch?{onToggle:function(){return $("#menu_blocker").show()},onOpened:function(){return setTimeout(function(){return $("#menu_blocker").hide()},400)},onClosed:function(){return $("#tictail_search_box").val(""),$(".results_box").hide(),setTimeout(function(){return $("#menu_blocker").hide()},400)}}:{onClosed:function(){return $("#tictail_search_box").val(""),$(".results_box").hide()}},i.length&&g.push(i.first()[0]),b=new krmg.SlideMenu(document.getElementById("navigation"),g,e),Hammer($(".navigation_toggle")).on("tap",function(){return b.toggle()}),f(),c=".page_column",d=$.sammy(c,function(){return this.get("/",function(b){"index"!==a&&b.load("/").then(function(a){krmg.HTML.read(a,c),f()})}),this.get(/products\/(.*)/,function(b){var d;return d=b.params.splat[0],a=d,b.load("/products/"+d).then(function(a){krmg.HTML.read(a,c),f()})}),this.get(/product\/(.*)/,function(a){var b,d,e;b=a.params.splat[0],e=$(".page_column a[href$='product/"+b+"']"),$(".page_column .selected").removeClass("selected"),e.addClass("selected"),d=krmg.ProductList.show(this.path),d||a.load("/product/"+b).then(function(a){return krmg.ProductList.flush(),krmg.HTML.read(a,c),f()})}),this.get(/page\/(.*)/,function(b){var d;d=b.params.splat[0],a=d,b.load("/page/"+d).then(function(a){return krmg.ProductList.flush(),krmg.HTML.read(a,c),f()})}),this.bind("event-context-after",function(){var a;a=$("a[href$='"+this.path.replace(/^\/\#|^\//,"")+"']"),$("a.selected").removeClass("selected"),a.length&&a.addClass("selected"),b.close()})}),Modernizr.history?d.run():void 0}),c=function(){return e?void 0:(e=!0,window.requestAnimationFrame(function(){return krmg.LazyImage.load(),e=!1}))},Modernizr.touch?document.addEventListener("touchmove",c):$(window).on("scroll",c),$(window).on("resize",function(){return d?void 0:(d=!0,window.requestAnimationFrame(function(){return krmg.ProductList.index(),krmg.LazyImage.load(),g&&(g.size("load"),g.size("write"),g.swipe.setup()),d=!1}))})}.call(this),function(){var a,b,c,d,e;null==(e=(d="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(d.krmg={}),a="data-src",c=[],b=function(a,b){var c,d;return c=a.offsetParent,d=a.parentNode.getBoundingClientRect(),0===d.top?c?d=c.getBoundingClientRect():!1:d.top>=0&&d.top<=b||d.bottom>=0&&d.bottom<=b},krmg.LazyImage={init:function(){var b,d,e,f;for(d=document.getElementsByTagName("img"),e=0,f=d.length;f>e;e++)b=d[e],null!=b.getAttribute(a)&&c.push(b);return this},load:function(){var a,d,e,f,g,h,i;for(a=window.innerHeight||document.documentElement.clientHeight,e=[],f=0,h=c.length;h>f;f++)d=c[f],b(d,2*a)&&e.push(d);for(g=0,i=e.length;i>g;g++)d=e[g],this.get(d);return this},get:function(b){var c;return c=b.getAttribute(a),b.src!==c&&(b.src=c),this}}}.call(this),function(){var a,b;null==(b=(a="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(a.krmg={}),krmg.SlideMenu=function(){function a(a,b,c){var d=this;this.menu=a,this.content=b,this.options=null!=c?c:{},this.animate=this.content,this.animate.push(this.menu),this.touch=Hammer(window),this.touch.on("dragstart dragleft dragright swipeleft swiperight release dragup dragdown",function(a){return d.touchHandler(a)}),this.width=this.menu.offsetWidth,this.close()}return a.IS_ACTIVE="open",a.IS_INACTIVE="close",a.prototype.actionHandler=function(b){return b.stopPropagation(),b.preventDefault(),this.state===a.IS_ACTIVE?this.close():this.open()},a.prototype.touchHandler=function(b){var c,d;if(!(b.result&&b.result instanceof krmg.Swipe)){switch(b.type){case"dragstart":b.target&&"product_slide_figure"===b.target.className&&(this.ignore=!0);break;case"dragup":case"dragdown":this.change?(b.preventDefault(),b.gesture.preventDefault()):this.ignore=!0;break;case"dragright":case"dragleft":if(this.ignore)return;this.change=!0,b.preventDefault(),b.gesture.preventDefault(),c=20,Math.abs(b.gesture.deltaX)>c&&(d="open"===this.state?Math.max(0,Math.min(this.width,this.width+b.gesture.deltaX-c)):Math.max(0,Math.min(this.width,b.gesture.deltaX-c)),TweenLite.set(this.content,{x:d,overwrite:!0}));break;case"swiperight":if(this.ignore)return;b.preventDefault(),this.open();break;case"swipeleft":if(this.ignore)return;b.preventDefault(),this.close();break;case"release":b.preventDefault(),this.change&&(this.state===a.IS_ACTIVE?Math.abs(b.gesture.deltaX)>.5*this.width&&b.gesture.direction===Hammer.DIRECTION_LEFT?this.close():this.open():Math.abs(b.gesture.deltaX)>.5*this.width&&b.gesture.direction===Hammer.DIRECTION_RIGHT?this.open():this.close()),this.ignore=!1,this.change=!1}return!1}},a.prototype.open=function(){var b=this;return TweenLite.to(this.animate,.25,{x:this.width,overwrite:!0,onComplete:function(){return b.state=a.IS_ACTIVE,b.options.onOpened?b.options.onOpened.call():void 0}}),this},a.prototype.close=function(){var b=this;return TweenLite.to(this.animate,.25,{x:0,clearProps:"x",overwrite:!0,onComplete:function(){b.state=a.IS_INACTIVE,b.options.onClosed&&b.options.onClosed.call()}}),this},a.prototype.toggle=function(){return this.options.onToggle&&this.options.onToggle.call(),this.state===a.IS_ACTIVE?this.close():this.open(),this},a}()}.call(this),function(){var a,b;a=function(a){var b,c;return c=a.parentNode,b=a.nextSibling,c.removeChild(a),function(){return b?c.insertBefore(a,b):c.appendChild(a)}},b=function(a){var c,d,e,f;if(a.removeAttribute("style"),a.children.length)for(f=a.children,d=0,e=f.length;e>d;d++)c=f[d],b(c);return a},$(document).ready(function(){var c,d,e,f,g;if(e=$(".html_content"),e.length)for(f=0,g=e.length;g>f;f++)c=e[f],d=a(c),b(c),c.className=c.className.replace(/html_content\s*/,""),d()})}.call(this),function(){var a,b,c;a=function(){function a(){this.list=[],this.first=[]}return a.prototype.show=function(a){var b,c,d,e,f,g,h,i,j;for(a=a.replace(krmg.RE.clean,""),b=null,i=this.list,e=0,g=i.length;g>e;e++)d=i[e],d.url===a&&(b=d);if(!b)return!1;for(j=this.list,f=0,h=j.length;h>f;f++)d=j[f],d!==b&&d.row===b.row&&d.select(!1);return this.active=b,this.insert_detail(b,b.row+1),b.select(),c=40,setTimeout(function(){}),TweenLite.to(window,.25,{scrollTo:{y:b.detail.offset().top-c,x:$(window).scrollLeft(),autoKill:!1},ease:Power2.easeIn}),this},a.prototype.insert_detail=function(a,b){var c,d,e,f;this.container||(this.container=$(".product_list")),f=null,c=a.detail[0],e=a.container.parent()[0],this.first[b]&&(f=this.first[b].container[0]);try{e.insertBefore(c,f)}catch(g){d=g,console.log(d)}return this},a.prototype.load=function(){var a,b,c,d;if(b=$(".product_list .product"),b.length)for(c=0,d=b.length;d>c;c++)a=b[c],this.list.push(new krmg.Product($(a)));return this},a.prototype.index=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(e=f=-1,b=[];this.first.length;)this.first.pop();for(s=this.list,g=0,k=s.length;k>g;g++)a=s[g],a.selected&&(a.select(!1),b.push(a));for(t=this.list,h=0,l=t.length;l>h;h++)a=t[h],a.size("reset");for(u=this.list,i=0,m=u.length;m>i;i++)a=u[i],a.size("load");for(v=this.list,j=0,n=v.length;n>j;j++)a=v[j],a.size("write");for(w=this.list,q=0,o=w.length;o>q;q++)a=w[q],a.size().top>f&&(e++,this.first[e]=a),a.row=e,f=a.size().top;if(c=-1,this.active)for(r=0,p=b.length;p>r;r++)a=b[r],d=a.row+1,(a===this.active||a.row!==this.active.row&&d!==c)&&(this.insert_detail(a,d),a.select(!0),c=d);return this},a.prototype.flush=function(){for(this.active=null;this.first.length;)this.first.pop();for(;this.list.length;)this.list.pop()["delete"]();return this},a}(),null==(c=(b="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(b.krmg={}),krmg.ProductList=new a}.call(this),function(){var a,b;null==(b=(a="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(a.krmg={}),krmg.Product=function(){function a(a){this.container=a,this.teaser=this.container.find(".product_teaser").first(),this.detail=this.container.find(".product_detail").first(),this.slider=this.container.find(".product_slide").first(),this.images=this.container.find(".product_slide_figure img"),this.index=this.container.find(".product_slider_index").first(),this.parent=this.container.parent(),this.swipe=null,this.teaser.length?(this.detail.detach(),this.detail.show(),this.row=0,this.url=this.teaser.attr("href").replace(krmg.RE.clean,"")):(this.size("load"),this.size("write"),this.select(!0))}return a.prototype.select=function(a){var b,c,d,e,f,g=this;if(this.selected=null!=a?a:!0,this.selected){for(f=this.images,d=0,e=f.length;e>d;d++)b=f[d],c=b.getAttribute("data-src"),b.removeAttribute("data-src"),null!=c&&(b.src=c);this.swipe?this.swipe&&this.swipe.setup():(this.index.length&&this.index.children().length>1&&(this.index.children()[0].className="active",this.index.show()),this.swipe=new krmg.Swipe(this.slider[0],{continuous:!0,disableScroll:!1,stopPropagation:!1,mouse:!0,transitionEnd:function(a,b,c){var d;return d=parseInt(c.getAttribute("data-index")),g.index.length?(g.index.children().removeClass("active"),g.index.children()[d].className="active"):void 0}})),this.social||(null!=window.FB&&FB.XFBML.parse(this.detail[0]),null!=window.twttr&&twttr.widgets.load(),this.social=!0)}else this.detail.detach();return this},a.prototype.size=function(a){return"reset"===a||("load"===a?(this.parent_bounds=this.parent[0].getBoundingClientRect(),this.bounds=this.container[0].getBoundingClientRect()):(a="write")&&this.slider.height(Math.round(this.parent_bounds.width*(2/3)))),this.bounds},a.prototype.top=function(){return this.container.position().top},a.prototype["delete"]=function(){var a;for(a in this)this[a]instanceof jQuery&&this[a].off(),this.hasOwnProperty(a)&&(this[a]=null)},a}()}.call(this),function(){var a,b;null==(b=(a="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(a.krmg={}),krmg.SelectLable=function(){function a(a){return this.label=a instanceof jQuery?a:$(a),this.select=this.label.prev(),this.select.hasClass("tictail_variations_select")?(this.setup(),void 0):(this.label=null,this.select=null,void 0)}return a.prototype.prefix="",a.prototype.setup=function(){var a,b,c,d,e,f,g=this;for(this.select.on("change",function(){return g.changed()}),this.options=$("<div class='variations_option_container'>"),this.options.on("click",function(a){return g.select[0].selectedIndex=a.target.getAttribute("data-index"),g.changed(),g.options.slideToggle("fast")}),a="",f=this.select[0].options,b=d=0,e=f.length;e>d;b=++d)c=f[b],a+="<div class='variations_option' data-index='"+b+"'>"+c.innerHTML+"</div>";this.options[0].innerHTML=a,this.label.after(this.options),this.label.on("click",function(){return g.options.slideToggle("fast")}),this.changed()},a.prototype.changed=function(){var a,b;try{return a=$(this.select[0].options[this.select[0].selectedIndex]),this.label.html(a[0].innerHTML)}catch(c){return b=c,console.log(b)}},a}()}.call(this),function(){var a,b;null==(b=(a="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(a.krmg={}),krmg.Swipe=function(){function a(a,b){var c,d=this;return this.container=a,this.options=null!=b?b:{},this.wrapper=this.container.children[0],this.index=0,this.speed=400,this.setup(),c={setup:function(){return d.setup(),d},prev:function(){return d.stop(),d.prev(),d},next:function(){return d.stop(),d.next(),d},kill:function(){d.teardown()}},c.__proto__=this.__proto__,c}return a.prototype.stop=function(){return this},a.prototype.prev=function(){return TweenLite.set(this.wrapper,{x:"-="+this.width}),this.index=this.circle(this.index-1),this.layout(),this.move(),this},a.prototype.next=function(){return TweenLite.set(this.wrapper,{x:"+="+this.width}),this.index=this.circle(this.index+1),this.layout(),this.move(),this},a.prototype.circle=function(a){return(this.length+a%this.length)%this.length},a.prototype.teardown=function(){var a,b,c,d;for(this.touch&&this.touch.off(),d=this.slides,b=0,c=d.length;c>b;b++)a=d[b],a.removeAttribute("style");this.wrapper.removeAttribute("style"),this.container.removeAttribute("style"),this.index=0,this.slides=[]},a.prototype.setup=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this;for(this.length=this.wrapper.children.length,d=0,l=this.wrapper.children,b=f=0,i=l.length;i>f;b=++f)a=l[b],a.setAttribute("data-index",b);if(this.length>1)for(;this.length<5;)c=this.wrapper.children[d].cloneNode(!0),d++,this.wrapper.appendChild(c),this.length++;for(this.slides=[],this.direction=0,m=this.wrapper.children,g=0,j=m.length;j>g;g++)e=m[g],this.slides.push(e);for(this.bounds=this.container.getBoundingClientRect(),this.width=this.bounds.width,this.height=this.bounds.height,this.wrapper.style.height=""+this.height+"px",this.wrapper.style.width=""+this.width+"px",this.wrapper.style.position="absolute",!this.touch&&this.length>1&&(this.touch=Hammer(this.container),this.touch.on("tap swipeleft dragleft swiperight dragright touch release",function(a){return o.dragHandler(a)}),this.touch.on("click mousemove",function(a){var b,c;return c=a.pageY-o.bounds.top,b=a.pageX-o.bounds.left,1!==o.direction&&b>.5*o.width?(o.container.setAttribute("data-direction","next"),o.direction=1):-1!==o.direction&&b<.5*o.width&&(o.container.setAttribute("data-direction","prev"),o.direction=-1),"click"===a.type&&(1===o.direction&&o.next(),-1===o.direction)?o.prev():void 0}),this.touch.on("click",function(a){return a.preventDefault()}),this.touch.on("dragstart",function(a){return"img"===a.target.tagName.toLowerCase()?a.preventDefault():void 0}),this.options.mouse&&this.touch.on("click mousemove",function(a){var b,c;return c=a.pageY-o.bounds.top,b=a.pageX-o.bounds.left,1!==o.direction&&b>.5*o.width?(o.container.setAttribute("data-direction","next"),o.direction=1):-1!==o.direction&&b<.5*o.width?(o.container.setAttribute("data-direction","prev"),o.direction=-1):void 0})),n=this.slides,h=0,k=n.length;k>h;h++)c=n[h],c.style.width=""+this.width+"px",c.style.height=""+this.height+"px";return this.layout(),this},a.prototype.layout=function(){var a,b,c,d,e;for(e=this.slides,b=c=0,d=e.length;d>c;b=++c)a=e[b],b===this.index?(a.style.left=0,a.style.visibility="visible"):b===this.circle(this.index+1)?(a.style.left=""+1*this.width+"px",a.style.visibility="visible"):b===this.circle(this.index+2)?(a.style.left=""+2*this.width+"px",a.style.visibility="visible"):b===this.circle(this.index-1)?(a.style.left=""+-1*this.width+"px",a.style.visibility="visible"):b===this.circle(this.index-2)?(a.style.left=""+-2*this.width+"px",a.style.visibility="visible"):a.style.visibility="hidden";return this},a.prototype.dragHandler=function(a){var b;switch(null==this.offset&&(this.offset=0),b=Math.min(this.width,Math.max(-this.width,a.gesture.deltaX)),a.type){case"tap":this.options.onClick&&this.options.onClick(a,this.index,this.slides[this.index]);break;case"touch":this.t?(this.offset=Math.round(this.t.target._gsTransform.x),this.t=null):this.offset=0,TweenLite.killTweensOf(this.wrapper);break;case"dragleft":case"dragright":a.gesture.preventDefault(),TweenLite.set(this.wrapper,{x:b,overwrite:!0});break;case"swipeleft":a.gesture.preventDefault(),this.pendingTouch="next";break;case"swiperight":a.gesture.preventDefault(),this.pendingTouch="prev";break;case"release":"prev"===this.pendingTouch||b>Math.min(250,.5*this.width)?this.prev():"next"===this.pendingTouch||b<Math.max(-250,this.width*-.5)?this.next():this.move(!0),this.pendingTouch=null}return this},a.prototype.move=function(a){var b=this;return this.t=TweenLite.to(this.wrapper,this.speed/1e3,{x:0,overwrite:!0,clearProps:"x",onComplete:function(){return b.options.transitionEnd&&!a&&requestAnimationFrame(function(){return b.options.transitionEnd&&!a?b.options.transitionEnd(b,b.index,b.slides[b.index]):void 0}),b.offset=0,b.t=null}})},a}()}.call(this),function(){var a,b;null==(b=(a="undefined"!=typeof exports&&null!==exports?exports:this).krmg)&&(a.krmg={}),krmg.RE={wash1:/<(script|head|style|iframe|frame|noscript)[^\>]*>[\s\S]*?<\/.*?\1>/gi,wash2:/<(!doctype|head|html|body).*?>/gi,wash3:/<\/.*?(head|html|body)>/gi,wash4:/<!--[\s\S]*?-->/gi,clean:/^\/\#|^\/|\#|\/\#/},krmg.HTML={wash:function(a){return a=a.replace(krmg.RE.wash1,""),a=a.replace(krmg.RE.wash2,""),a=a.replace(krmg.RE.wash3,""),a=a.replace(krmg.RE.wash4,"")},read:function(a,b){var c,d,e;if(a=this.wash(a),d=document,null!=document.implementation&&null!=document.implementation.createHTMLDocument)try{d=document.implementation.createHTMLDocument("")}catch(f){e=f,d=document}c=d.createElement("div"),c.innerHTML=a,$(b).first().html($(c).find(b).first().html());try{return TT.store.domReady()}catch(f){return e=f,console.log("Missing TT.store.domReady")}}},krmg.ELEMENT={wash:function(a){var b,c,d,e;if(a.removeAttribute("style"),a.children.length)for(e=a.children,c=0,d=e.length;d>c;c++)b=e[c],this.wash(b);return a},insertLater:function(a){var b,c;return c=a.parentNode,b=a.nextSibling,c.removeChild(a),function(){return b?c.insertBefore(a,b):c.appendChild(a)}}}}.call(this);